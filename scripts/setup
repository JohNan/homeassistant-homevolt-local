#!/usr/bin/env bash

set -e

cd "$(dirname "$0")/.."

# Use uv for faster package installation (falls back to pip if uv not available)
if command -v uv &> /dev/null; then
    # Create virtual environment if it doesn't exist
    if [ ! -d ".venv" ]; then
        uv venv .venv
    fi
    # Use copy mode to avoid hardlink warnings in dev containers
    uv pip install --link-mode=copy --upgrade --requirement requirements.txt
    uv pip install --link-mode=copy --upgrade --requirement requirements-dev.txt
else
    python3 -m pip install --upgrade --requirement requirements.txt
    python3 -m pip install --upgrade --requirement requirements-dev.txt
fi

# Install pre-commit hooks
if command -v pre-commit &> /dev/null; then
    pre-commit install
fi
